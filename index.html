<!doctype html>
<!--
	ぬんサーチX（エックス）
	2025/4/9 Copyright @minatsukijun

	Xの検索を少し楽にするページです。休憩中にサッと作ったから安っぽいのは許してぬん
	(๑╹ᆺ╹)b
-->
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=360,initial-scale=1">
		<title>ぬんサーチX（えっくす）</title>
	</head>

	<body>
		<h3>ぬんサーチX（えっくす）</h3>
		<h4>オプション</h4>
		<p>
			<input type="checkbox" name="sorachan-love" id="checkboxSoraChanLoveModeEnabled">ときのそら（@tokino_sora）のポストだけを検索
		</p>
		<h4>1. 日付範囲指定（チェックで有効無効切り替え）</h4>
		<p>
			<input type="checkbox" name="since-enabled" id="checkboxSinceEnabled" checked>
			いつから？：<input type="date" name="since-date" id="textboxSinceDate" value="2017-09-07"> JST 00時00分00秒 から<br>
			　　　　　　　　<input type="button" name="since-yesterday" id="buttonSinceYesterdayTag" value="昨日をセット" onclick="clickSinceYesterdayButton()"><br><br>
			<input type="checkbox" name="until-enabled" id="checkboxUntilEnabled" checked>
			いつまで？：<input type="date" name="until-date" id="textboxUntilDate"> JST 23時59分59秒 まで
		</p>
		<h4>2. キーワード指定</h4>
		キーワード：<input type="text" name="name" id="textboxKeyword" size="20"><br>
		※　半角スペース区切り(AND検索)<br>
		" OR "を手入力して区切るとOR検索
		<p>
			<strong>↓自動入力ボタン</strong><br>
		<p>
			<input type="button" name="name-tag" id="buttonNameTag" value="#ときのそら" onclick="onClickTagButton(event)">
		</p>
		<p>
			<input type="button" name="livestream-tag" id="buttonLiveStreamTag" value="#ときのそら生放送" onclick="onClickTagButton(event)">
			<input type="button" name="fc-tag" id="buttonFcTag" value="#ときのそらFC" onclick="onClickTagButton(event)">
		</p>
		<p>
			<input type="button" name="art-tag" id="buttonArtTag" value="#そらArt" onclick="onClickTagButton(event)">
			<input type="button" name="old-art-tag" id="buttonOldArtTag" value="#soraArt" onclick="onClickTagButton(event)">
		</p>
		<p>
			<input type="button" name="listen-tag" id="buttonListenTag" value="#そらぬん聞いたよ" onclick="onClickTagButton(event)">
			<input type="button" name="issyo-tag" id="buttonIsshoTag" value="#ときのそらと一緒" onclick="onClickTagButton(event)">
		</p>
		<p>
			<input type="button" name="keepShinin-tag" id="buttonKeepShininTag" value="#ときのそら_KeepShinin" onclick="onClickTagButton(event)">
			<input type="button" name="sorapa2024-tag" id="buttonSorapa2024Tag" value="#そらぱ2024" onclick="onClickTagButton(event)">
		</p>
		</p>
		<h4>3. 設定した条件でXを検索</h4>
		<p>
			<input class="button" type="button" value="Xで検索 (๑╹ᆺ╹)ぬん！" onclick="openPage()">
		</p>
	</body>

	<script>
		/** @type {() => string} - 今日の日付を"YYYY-MM-DD"形式の文字列で取得 */
		function getTodayDate() {
			// 実はこれでいけちゃうんです…… https://www.ey-office.com/blog_archive/2023/04/18/short-code-to-get-todays-date-in-yyyy-mm-dd-format-in-javascript/
			return new Date().toLocaleDateString('sv-SE', { timeZone: 'Asia/Tokyo' });
		}
		/** @type {() => string} - 昨日の日付を"YYYY-MM-DD"形式の文字列で取得 */
		function getYesterdayDate() {
			var yesterday = new Date();
			yesterday.setDate(yesterday.getDate() - 1);
			return yesterday.toLocaleDateString('sv-SE', { timeZone: 'Asia/Tokyo' });
		}

		window.onload = function updateUntilDate() {
			var today = getTodayDate();
			document.getElementById('textboxUntilDate').value = today;
		}
		function clickSinceYesterdayButton() {
			var yesterday = getYesterdayDate();
			document.getElementById('textboxSinceDate').value = yesterday;
		}
		function onClickTagButton(event) {
			var hashTag = event.target.value;
			var keyword = document.getElementById('textboxKeyword').value;
			if (keyword !== "") {
				keyword += " ";
			}
			document.getElementById('textboxKeyword').value = keyword + hashTag;
		}
		function openPage() {
			var keyword = document.getElementById('textboxKeyword').value;
			var searchQuery = keyword;
			if (document.getElementById('checkboxSoraChanLoveModeEnabled').checked === true) {
				searchQuery += " from:tokino_sora";
			}
			if (document.getElementById('checkboxSinceEnabled').checked === true) {
				searchQuery += " since:" + document.getElementById('textboxSinceDate').value + "_00:00:00_JST";
			}
			if (document.getElementById('checkboxUntilEnabled').checked === true) {
				searchQuery += " until:" + document.getElementById('textboxUntilDate').value + "_23:59:59_JST";
			}
			var openUrl = "https://x.com/search?q=" + encodeURIComponent(searchQuery) + "&src=typed_query&f=top";
			window.open(openUrl, '_blank');
		}
	</script>

</html>
